<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../../components/core-range/core-range.html">

<!--
Candy cane progress bar.

@element preload-overlay
@extends core-range
-->
<polymer-element name="preload-overlay" extends="core-range"
                 attributes="active color src" fit>
  <template>
    <!-- TODO: CSS separated because of
         https://github.com/Polymer/polymer/issues/811 -->
    <link rel="stylesheet" href="preloader.css" no-shim>
    <style>
    :host {
      background: #3ec4f0;
      z-index: 1000;
      transition: opacity 500ms ease-in-out;
      opacity: 0;
      visibility: hidden;
    }
    :host([active]) {
      opacity: 1;
      visibility: visible;
    }
    </style>
    <div id="page-progress" layout vertical center-center>
      <div class="preload">
        <img _src="{{src}}">
        <div class="preload-bar">
          <div class="preload-progress" _style="width:{{ratio}}%;"></div>
        </div>
      </div>
    </div>
  </template>
  <script>
    Polymer({
      /**
       * Background color of the loading screen.
       *
       * @attribute color
       * @type string
       * @default '#3ec4f0'
       */
      color: '#3ec4f0',

      /**
       * Loading image
       *
       * @attribute src
       * @type string
       * @default '/images/village.gif'
       */
      src: '/images/village.gif',

      publish: {
        /**
         * If `true`, the preloader displays itself. 
         *
         * @attribute active
         * @type bool
         * @default false
         */
        active: {value: false, reflect: true}
      },

      colorChanged: function() {
        this.style.backgroundColor = this.color;
      }
    });
  </script>
</polymer-element>
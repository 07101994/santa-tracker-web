<link rel="import" href="../base-scene.html">

<script src="callfromsanta-scene.min.js"></script>
<script src="../shared/js/css_animation_helper.js"></script>

<!--
Call from santa scene.

@element callfromsanta-scene
@extends base-scene
-->
<polymer-element name="callfromsanta-scene" extends="base-scene">
<template>
  <link rel="stylesheet" href="callfromsanta-scene.css" no-shim>

  <div id="module-callfromsanta">
    <div class="scene">
      <div class="snow"></div>
      <div class="mountains"></div>
      <div class="computer-shadow"></div>
      <div class="forest">
        <div class="tree1"></div>
        <div class="tree2"></div>
        <div class="tree3"></div>
        <div class="tree4"></div>
        <div class="tree5"></div>
        <div class="tree6"></div>
        <div class="tree7"></div>
        <div class="tree9"></div>
        <div class="tree8"></div>
        <div class="tree10"></div>
      </div>
      <div class="sky">
        <div class="sun"></div>
        <div class="cloud cloud1 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud2 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud3 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud4 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud5 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud6 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud7 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="cloud cloud8 js-resize-animation"><div class="cloud-inner"></div></div>
        <div class="blimp"><div class="blimp-inner"></div></div>
      </div>

      <div class="computer">
        <div class="bg"></div>
        <div class="antenna">
          <div class="signal first"></div>
          <div class="signal second"></div>
          <div class="signal third"></div>
        </div>

        <div class="screen">
        </div>
        <div class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" width="74.961" height="22.558"><g opacity=".1"><path d="M8.076 4.141c-1.569 0-2.808.522-3.716 1.567s-1.362 2.476-1.362 4.292c0 1.869.438 3.312 1.313 4.332.875 1.019 2.124 1.527 3.745 1.527.996 0 2.132-.179 3.408-.537v1.455c-.99.371-2.21.557-3.662.557-2.103 0-3.726-.638-4.868-1.914-1.143-1.275-1.714-3.089-1.714-5.439 0-1.471.275-2.76.825-3.867s1.345-1.96 2.384-2.559 2.261-.898 3.667-.898c1.498 0 2.806.273 3.926.82l-.703 1.426c-1.081-.508-2.162-.762-3.243-.762zM21.66 17.138v-6.923c0-.873-.199-1.523-.596-1.953s-1.019-.645-1.865-.645c-1.126 0-1.948.306-2.466.918s-.776 1.615-.776 3.007v5.596h-1.621v-15.195h1.621v4.6c0 .553-.026 1.012-.078 1.377h.098c.318-.514.773-.92 1.362-1.216s1.261-.444 2.016-.444c1.309 0 2.29.311 2.944.933s.981 1.61.981 2.964v6.982h-1.62zM31.494 6.24c.475 0 .902.039 1.279.117l-.225 1.504c-.443-.098-.833-.146-1.172-.146-.866 0-1.606.352-2.222 1.055s-.923 1.579-.923 2.627v5.742h-1.621v-10.703h1.338l.186 1.982h.078c.397-.697.875-1.234 1.436-1.611s1.176-.567 1.846-.567zM44.014 11.777c0 1.745-.439 3.107-1.318 4.088-.879.979-2.093 1.469-3.643 1.469-.957 0-1.807-.225-2.549-.674s-1.315-1.094-1.719-1.934-.605-1.822-.605-2.949c0-1.744.436-3.104 1.309-4.077s2.083-1.46 3.633-1.46c1.498 0 2.687.498 3.569 1.494.881.996 1.323 2.344 1.323 4.043zm-8.155 0c0 1.367.273 2.409.82 3.125.547.717 1.351 1.074 2.412 1.074s1.867-.355 2.417-1.068.825-1.757.825-3.131c0-1.36-.275-2.394-.825-3.1s-1.362-1.06-2.437-1.06c-1.061 0-1.862.348-2.402 1.045s-.81 1.735-.81 3.115zM60.498 17.138v-6.962c0-.853-.183-1.493-.547-1.919-.365-.426-.932-.64-1.699-.64-1.01 0-1.755.29-2.236.869-.482.58-.723 1.471-.723 2.676v5.976h-1.621v-6.962c0-.853-.183-1.493-.547-1.919-.365-.426-.935-.64-1.709-.64-1.016 0-1.76.304-2.231.913-.473.609-.708 1.606-.708 2.993v5.615h-1.621v-10.702h1.318l.264 1.464h.078c.306-.521.737-.928 1.294-1.221s1.18-.439 1.87-.439c1.673 0 2.767.605 3.281 1.816h.078c.318-.56.781-1.002 1.387-1.328s1.295-.488 2.07-.488c1.211 0 2.117.311 2.72.933.602.622.903 1.616.903 2.983v6.982h-1.621zM69.98 17.333c-1.582 0-2.831-.481-3.745-1.445-.915-.963-1.372-2.301-1.372-4.014 0-1.725.425-3.095 1.274-4.111s1.99-1.523 3.423-1.523c1.341 0 2.402.441 3.184 1.323s1.172 2.046 1.172 3.491v1.025h-7.373c.032 1.257.35 2.211.952 2.861.602.651 1.45.977 2.544.977 1.152 0 2.291-.24 3.418-.723v1.445c-.573.248-1.115.426-1.626.533-.512.109-1.128.161-1.851.161zm-.439-9.735c-.859 0-1.545.28-2.056.84-.512.56-.812 1.334-.903 2.324h5.596c0-1.022-.229-1.805-.684-2.349-.456-.543-1.107-.815-1.953-.815z"/></g></svg>
        </div>
        <div class="foot left"></div>
        <div class="foot right"></div>
      </div>
    </div>

    <div class="gui">
      <div class="board board--scene">
        <a id="global-back-to-village" href="{{pageUrl}}#village" class="back"><i18n-msg msgid="gotovillage">PLACEHOLDER_i18n</i18n-msg></a>
        <div class="logo"></div>
        <div class="actions" hidden>
          <button type="button" class="restart"></button>
          <button type="button" class="pause"></button>
        </div>
      </div>
    </div>
    <iframe id="santa-iframe" src="about:blank" width="100%" height="100%" frameBorder="0"></iframe>
  </div>
</template>
<script>
  Polymer({
    componentDir: 'scenes/callfromsanta/',

    onPreload: function() {
      this.preloadSounds('callfromsanta_load_sounds', 30);
      this.preloadImages([
        'img/logo.svg',
        'img/sprite.png'
      ]);
    },

    onShow: function() {
      this.fire('sound-ambient', 'callfromsanta_start');
      var div = this.$['module-callfromsanta'];

      this.animationHelper = new CSSAnimationHelper(div);
      this.scene = new scenes.callfromsanta.Scene(div);
      this.scene.init();
    },

    onHide: function() {
      this.scene.destroy();
      this.scene = null;
      this.animationHelper.destroy();
      this.animationHelper = null;
      this.fire('sound-ambient', 'callfromsanta_end');
    }
  });
</script>
</polymer-element>

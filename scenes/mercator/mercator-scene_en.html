<link rel="import" href="../base-scene.html">
<link rel="import" href="../../elements/i18n-msg.html">
<link rel="import" href="../../components/google-apis/google-maps-api.html">

<script src="../shared/js/startbutton.js"></script>
<script src="mercator-scene.min.js"></script>

<!--
Mercator scene.

@element mercator-scene
@extends base-scene
-->
<polymer-element name="mercator-scene" extends="base-scene">
<template>
  <link rel="stylesheet" href="mercator-scene.css" no-shim>

  <div id="module-mercator">
    <div class="scene">
      <template if="{{santaApp}}">
        <google-maps-api version="3.exp" apiKey="{{santaApp.config.API_KEY}}"
                         clientId="{{santaApp.config.CLIENT_ID}}"
                         libraries="places,geometry"
                         language="{{santaApp.language}}"
                         on-api-load="{{mapsAPIReady}}"></google-maps-api>
      </template>
      <div class="map">
        <div class="gmap"></div>
      </div>
      <div class="bg"></div>
    </div>
    <div class="gui">
      <div class="board board--game">
        <a id="global-back-to-village" href="{{pageUrl}}#village" class="back"><i18n-msg msgid="gotovillage">PLACEHOLDER_i18n</i18n-msg></a>
        <div class="logo"></div>
        <div class="score">
          <div class="label">
            <i18n-msg msgid="score">PLACEHOLDER_i18n</i18n-msg>
          </div>
          <div class="value">0</div>
        </div>
        <div class="level has-count">
          <div class="label">
            <i18n-msg msgid="level">PLACEHOLDER_i18n</i18n-msg>
          </div>
          <div class="value"><span class="current-level">1</span><span class="dark-text">/10</span>
          </div>
          <div class="level-dots">
            <div class="level-item is-active">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">1</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">2</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">3</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">4</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">5</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">6</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">7</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">8</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">9</div>
            </div>
            <div class="level-item">
              <div class="level-dot"></div>
              <div class="level-shadow"></div>
              <div class="level-number">10</div>
            </div>
          </div>
        </div>
        <div class="time">
          <div class="label">
            <i18n-msg msgid="time">PLACEHOLDER_i18n</i18n-msg>
          </div>
          <div class="value"><span class="minutes dark-text">00</span><span class="dark-text"> : </span><span class="seconds">00</span></div>
          <div class="tracker">
            <div class="remaining"></div>
          </div>
          <div class="status"></div>
        </div>
        <div class="actions">
          <button type="button" class="restart"></button>
          <button type="button" class="pause"></button>
        </div>
      </div>
      <div class="levelup"></div>
      <div class="levelup--number"></div>
      <div class="gameover overlay">
        <div class="gameover-dialog overlay-dialog">
          <h2 class="gameover-title">
            <i18n-msg msgid="gameover">PLACEHOLDER_i18n</i18n-msg>
          </h2>
          <div class="gameover-winner">
            <div class="gameover-level">
              <p class="gameover-label">
                <i18n-msg msgid="gameover_level">PLACEHOLDER_i18n</i18n-msg>
              </p>
              <p class="gameover-number">0</p>
            </div>
            <div class="gameover-score">
              <p class="gameover-label">
                <i18n-msg msgid="gameover_score">PLACEHOLDER_i18n</i18n-msg>
              </p>
              <p class="gameover-number">0</p>
            </div>
          </div>
          <div class="gameover-buttons">
            <button type="button" class="Button Button--large gameover-play">
              <i18n-msg msgid="playagain">PLACEHOLDER_i18n</i18n-msg>
            </button>
            <div class="shareButtons"><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-google">Google+</a><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-facebook">Facebook</a><a href="javascript:;" target="_blank" class="Button Button--small Button--noText shareButtons-twitter">Twitter</a></div>
          </div>
        </div>
      </div>
      <div class="force-rotate landscape">
        <div class="force-rotate-graphic"></div>
        <div class="force-rotate-explanation">
          <i18n-msg msgid="tilt">PLACEHOLDER_i18n</i18n-msg>
        </div>
      </div>
    </div>
    <div class="countries">
      <ul>
        <li data-country="Australia"><i18n-msg msgid="australia">Australia</i18n-msg></li>
        <li data-country="New Zealand"><i18n-msg msgid="new_zealand">New Zealand</i18n-msg></li>
        <li data-country="Papua New Guinea"><i18n-msg msgid="papua_new_guinea">Papua New Guinea</i18n-msg></li>
        <li data-country="Argentina"><i18n-msg msgid="argentina">Argentina</i18n-msg></li>
        <li data-country="Bolivia"><i18n-msg msgid="bolivia">Bolivia</i18n-msg></li>
        <li data-country="Brazil"><i18n-msg msgid="brazil">Brazil</i18n-msg></li>
        <li data-country="Chile"><i18n-msg msgid="chile">Chile</i18n-msg></li>
        <li data-country="Colombia"><i18n-msg msgid="colombia">Colombia</i18n-msg></li>
        <li data-country="Ecuador"><i18n-msg msgid="ecuador">Ecuador</i18n-msg></li>
        <li data-country="Guyana"><i18n-msg msgid="guyana">Guyana</i18n-msg></li>
        <li data-country="Peru"><i18n-msg msgid="peru">Peru</i18n-msg></li>
        <li data-country="Paraguay"><i18n-msg msgid="paraguay">Paraguay</i18n-msg></li>
        <li data-country="Suriname"><i18n-msg msgid="suriname">Suriname</i18n-msg></li>
        <li data-country="Uruguay"><i18n-msg msgid="uruguay">Uruguay</i18n-msg></li>
        <li data-country="Venezuela"><i18n-msg msgid="venezuela">Venezuela</i18n-msg></li>
        <li data-country="Belize"><i18n-msg msgid="belize">Belize</i18n-msg></li>
        <li data-country="Costa Rica"><i18n-msg msgid="costa_rica">Costa Rica</i18n-msg></li>
        <li data-country="Cuba"><i18n-msg msgid="cuba">Cuba</i18n-msg></li>
        <li data-country="Dominican Republic"><i18n-msg msgid="dominican_republic">Dominican Republic</i18n-msg></li>
        <li data-country="Guatemala"><i18n-msg msgid="guatemala">Guatemala</i18n-msg></li>
        <li data-country="Honduras"><i18n-msg msgid="honduras">Honduras</i18n-msg></li>
        <li data-country="Haiti"><i18n-msg msgid="haiti">Haiti</i18n-msg></li>
        <li data-country="Jamaica"><i18n-msg msgid="jamaica">Jamaica</i18n-msg></li>
        <li data-country="Panama"><i18n-msg msgid="panama">Panama</i18n-msg></li>
        <li data-country="Puerto Rico"><i18n-msg msgid="puerto_rico">Puerto Rico</i18n-msg></li>
        <li data-country="El Salvador"><i18n-msg msgid="el_salvador">El Salvador</i18n-msg></li>
        <li data-country="Austria"><i18n-msg msgid="austria">Austria</i18n-msg></li>
        <li data-country="Belgium"><i18n-msg msgid="belgium">Belgium</i18n-msg></li>
        <li data-country="Belarus"><i18n-msg msgid="belarus">Belarus</i18n-msg></li>
        <li data-country="Switzerland"><i18n-msg msgid="switzerland">Switzerland</i18n-msg></li>
        <li data-country="Germany"><i18n-msg msgid="germany">Germany</i18n-msg></li>
        <li data-country="Denmark"><i18n-msg msgid="denmark">Denmark</i18n-msg></li>
        <li data-country="Estonia"><i18n-msg msgid="estonia">Estonia</i18n-msg></li>
        <li data-country="Finland"><i18n-msg msgid="finland">Finland</i18n-msg></li>
        <li data-country="France"><i18n-msg msgid="france">France</i18n-msg></li>
        <li data-country="Ireland"><i18n-msg msgid="ireland">Ireland</i18n-msg></li>
        <li data-country="Iceland"><i18n-msg msgid="iceland">Iceland</i18n-msg></li>
        <li data-country="Lithuania"><i18n-msg msgid="lithuania">Lithuania</i18n-msg></li>
        <li data-country="Latvia"><i18n-msg msgid="latvia">Latvia</i18n-msg></li>
        <li data-country="Netherlands"><i18n-msg msgid="netherlands">Netherlands</i18n-msg></li>
        <li data-country="Norway"><i18n-msg msgid="norway">Norway</i18n-msg></li>
        <li data-country="Poland"><i18n-msg msgid="poland">Poland</i18n-msg></li>
        <li data-country="Sweden"><i18n-msg msgid="sweden">Sweden</i18n-msg></li>
        <li data-country="Albania"><i18n-msg msgid="albania">Albania</i18n-msg></li>
        <li data-country="Bulgaria"><i18n-msg msgid="bulgaria">Bulgaria</i18n-msg></li>
        <li data-country="Bosnia and Herzegovina"><i18n-msg msgid="bosnia_and_herzegovina">Bosnia and Herzegovina</i18n-msg></li>
        <li data-country="Czech Republic"><i18n-msg msgid="czech_republic">Czech Republic</i18n-msg></li>
        <li data-country="Greece"><i18n-msg msgid="greece">Greece</i18n-msg></li>
        <li data-country="Croatia"><i18n-msg msgid="croatia">Croatia</i18n-msg></li>
        <li data-country="Hungary"><i18n-msg msgid="hungary">Hungary</i18n-msg></li>
        <li data-country="Italy"><i18n-msg msgid="italy">Italy</i18n-msg></li>
        <li data-country="Moldova"><i18n-msg msgid="moldova">Moldova</i18n-msg></li>
        <li data-country="Romania"><i18n-msg msgid="romania">Romania</i18n-msg></li>
        <li data-country="Slovakia"><i18n-msg msgid="slovakia">Slovakia</i18n-msg></li>
        <li data-country="Benin"><i18n-msg msgid="benin">Benin</i18n-msg></li>
        <li data-country="Burkina Faso"><i18n-msg msgid="burkina_faso">Burkina Faso</i18n-msg></li>
        <li data-country="Côte d'Ivoire"><i18n-msg msgid="cote_divoire">Côte d'Ivoire</i18n-msg></li>
        <li data-country="Algeria"><i18n-msg msgid="algeria">Algeria</i18n-msg></li>
        <li data-country="Ghana"><i18n-msg msgid="ghana">Ghana</i18n-msg></li>
        <li data-country="Guinea"><i18n-msg msgid="guinea">Guinea</i18n-msg></li>
        <li data-country="Liberia"><i18n-msg msgid="liberia">Liberia</i18n-msg></li>
        <li data-country="Libya"><i18n-msg msgid="libya">Libya</i18n-msg></li>
        <li data-country="Mali"><i18n-msg msgid="mali">Mali</i18n-msg></li>
        <li data-country="Mauritania"><i18n-msg msgid="mauritania">Mauritania</i18n-msg></li>
        <li data-country="Niger"><i18n-msg msgid="niger">Niger</i18n-msg></li>
        <li data-country="Nigeria"><i18n-msg msgid="nigeria">Nigeria</i18n-msg></li>
        <li data-country="Senegal"><i18n-msg msgid="senegal">Senegal</i18n-msg></li>
        <li data-country="Sierra Leone"><i18n-msg msgid="sierra_leone">Sierra Leone</i18n-msg></li>
        <li data-country="Togo"><i18n-msg msgid="togo">Togo</i18n-msg></li>
        <li data-country="Tunisia"><i18n-msg msgid="tunisia">Tunisia</i18n-msg></li>
        <li data-country="Angola"><i18n-msg msgid="angola">Angola</i18n-msg></li>
        <li data-country="Botswana"><i18n-msg msgid="botswana">Botswana</i18n-msg></li>
        <li data-country="Central African Republic"><i18n-msg msgid="central_african_republic">Central African Republic</i18n-msg></li>
        <li data-country="Cameroon"><i18n-msg msgid="cameroon">Cameroon</i18n-msg></li>
        <li data-country="Democratic Republic of the Congo"><i18n-msg msgid="democratic_republic_of_the_congo">Democratic Republic of the Congo</i18n-msg></li>
        <li data-country="Republic of Congo"><i18n-msg msgid="republic_of_congo">Republic of Congo</i18n-msg></li>
        <li data-country="Eritrea"><i18n-msg msgid="eritrea">Eritrea</i18n-msg></li>
        <li data-country="Ethiopia"><i18n-msg msgid="ethiopia">Ethiopia</i18n-msg></li>
        <li data-country="Gabon"><i18n-msg msgid="gabon">Gabon</i18n-msg></li>
        <li data-country="Madagascar"><i18n-msg msgid="madagascar">Madagascar</i18n-msg></li>
        <li data-country="Mozambique"><i18n-msg msgid="mozambique">Mozambique</i18n-msg></li>
        <li data-country="Malawi"><i18n-msg msgid="malawi">Malawi</i18n-msg></li>
        <li data-country="Namibia"><i18n-msg msgid="namibia">Namibia</i18n-msg></li>
        <li data-country="Somaliland"><i18n-msg msgid="somaliland">Somaliland</i18n-msg></li>
        <li data-country="Somalia"><i18n-msg msgid="somalia">Somalia</i18n-msg></li>
        <li data-country="Chad"><i18n-msg msgid="chad">Chad</i18n-msg></li>
        <li data-country="Tanzania"><i18n-msg msgid="tanzania">Tanzania</i18n-msg></li>
        <li data-country="Uganda"><i18n-msg msgid="uganda">Uganda</i18n-msg></li>
        <li data-country="Zambia"><i18n-msg msgid="zambia">Zambia</i18n-msg></li>
        <li data-country="Zimbabwe"><i18n-msg msgid="zimbabwe">Zimbabwe</i18n-msg></li>
        <li data-country="Bangladesh"><i18n-msg msgid="bangladesh">Bangladesh</i18n-msg></li>
        <li data-country="Bhutan"><i18n-msg msgid="bhutan">Bhutan</i18n-msg></li>
        <li data-country="Indonesia"><i18n-msg msgid="indonesia">Indonesia</i18n-msg></li>
        <li data-country="Lao PDR"><i18n-msg msgid="lao_pdr">Lao PDR</i18n-msg></li>
        <li data-country="Sri Lanka"><i18n-msg msgid="sri_lanka">Sri Lanka</i18n-msg></li>
        <li data-country="Myanmar"><i18n-msg msgid="myanmar">Myanmar</i18n-msg></li>
        <li data-country="Malaysia"><i18n-msg msgid="malaysia">Malaysia</i18n-msg></li>
        <li data-country="Nepal"><i18n-msg msgid="nepal">Nepal</i18n-msg></li>
        <li data-country="Philippines"><i18n-msg msgid="philippines">Philippines</i18n-msg></li>
        <li data-country="Taiwan"><i18n-msg msgid="taiwan">Taiwan</i18n-msg></li>
        <li data-country="Vietnam"><i18n-msg msgid="vietnam">Vietnam</i18n-msg></li>
        <li data-country="Afghanistan"><i18n-msg msgid="afghanistan">Afghanistan</i18n-msg></li>
        <li data-country="United Arab Emirates"><i18n-msg msgid="united_arab_emirates">United Arab Emirates</i18n-msg></li>
        <li data-country="Iran"><i18n-msg msgid="iran">Iran</i18n-msg></li>
        <li data-country="Iraq"><i18n-msg msgid="iraq">Iraq</i18n-msg></li>
        <li data-country="Kazakhstan"><i18n-msg msgid="kazakhstan">Kazakhstan</i18n-msg></li>
        <li data-country="Kyrgyzstan"><i18n-msg msgid="kyrgyzstan">Kyrgyzstan</i18n-msg></li>
        <li data-country="Oman"><i18n-msg msgid="oman">Oman</i18n-msg></li>
        <li data-country="Saudi Arabia"><i18n-msg msgid="saudi_arabia">Saudi Arabia</i18n-msg></li>
        <li data-country="Tajikistan"><i18n-msg msgid="tajikistan">Tajikistan</i18n-msg></li>
        <li data-country="Turkmenistan"><i18n-msg msgid="turkmenistan">Turkmenistan</i18n-msg></li>
        <li data-country="Turkey"><i18n-msg msgid="turkey">Turkey</i18n-msg></li>
        <li data-country="Uzbekistan"><i18n-msg msgid="uzbekistan">Uzbekistan</i18n-msg></li>
        <li data-country="Yemen"><i18n-msg msgid="yemen">Yemen</i18n-msg></li>
        <li data-country="United States"><i18n-msg msgid="united_states">United States</i18n-msg></li>
        <li data-country="Greenland"><i18n-msg msgid="greenland">Greenland</i18n-msg></li>
        <li data-country="Canada"><i18n-msg msgid="canada">Canada</i18n-msg></li>
        <li data-country="Mexico"><i18n-msg msgid="mexico">Mexico</i18n-msg></li>
      </ul>
    </div>
  </div>

</template>
<script>
(function() {
  Polymer({
    componentDir: 'scenes/mercator/',

    game: null,

    showOnMapsReady: false,

    mapsReady: false,

    onPreload: function() {
      this.preloadSounds('mercator_load_sounds', 40);
      this.preloadImages([
        'img/bg.svg',
        'img/logo.svg',
        'img/pausescreen.svg',
        'img/tutorial/shadow.svg'
      ]);
    },
    onShow: function() {
      if (!this.mapsReady) {
        this.showOnMapsReady = true;
      } else {
        var module = this.$['module-mercator'];

        var game = this.game = new scenes.mercator.Game(module);
        startButton(module, function() {
          game.start();
        });
      }
    },
    onHide: function() {
      this.game.dispose();
      this.game = null;
      this.fire('sound-ambient', 'mercator_end');
    },
    mapsAPIReady: function() {
      this.mapsReady = true;
      if (this.showOnMapsReady) {
        this.onShow();
      }
    }
  });

})();
</script>
</polymer-element>
